# Description: Compile in our own PowerSaveBlocker implementation that
#  can delegate to Oxide
# Author: Chris Coulson <chris.coulson@canonical.com>

diff --git a/content/content_browser.gypi b/content/content_browser.gypi
--- a/content/content_browser.gypi
+++ b/content/content_browser.gypi
@@ -35,16 +35,17 @@
     # headers resolve correctly.
     '../third_party/WebKit/public/blink_headers.gyp:blink_headers',
     # The public render_widget_host.h needs to re-export skia defines.
     '../skia/skia.gyp:skia',
   ],
   'include_dirs': [
     '..',
     '<(INTERMEDIATE_DIR)',
+    '<(DEPTH)/../../..',
   ],
   'variables': {
     'public_browser_sources': [
       'public/browser/access_token_store.h',
       'public/browser/android/compositor.h',
       'public/browser/android/compositor_client.h',
       'public/browser/android/content_view_core.h',
       'public/browser/android/content_view_layer_renderer.h',
@@ -934,23 +935,23 @@
       'browser/power_profiler/power_data_provider.h',
       'browser/power_profiler/power_event.cc',
       'browser/power_profiler/power_event.h',
       'browser/power_profiler/power_profiler_observer.h',
       'browser/power_profiler/power_profiler_service.cc',
       'browser/power_profiler/power_profiler_service.h',
       'browser/power_save_blocker_android.cc',
       'browser/power_save_blocker_android.h',
-      'browser/power_save_blocker_chromeos.cc',
+      #'browser/power_save_blocker_chromeos.cc',
       'browser/power_save_blocker_impl.cc',
       'browser/power_save_blocker_impl.h',
-      'browser/power_save_blocker_mac.cc',
-      'browser/power_save_blocker_ozone.cc',
-      'browser/power_save_blocker_win.cc',
-      'browser/power_save_blocker_x11.cc',
+      #'browser/power_save_blocker_mac.cc',
+      #'browser/power_save_blocker_ozone.cc',
+      #'browser/power_save_blocker_win.cc',
+      #'browser/power_save_blocker_x11.cc',
       'browser/profiler_controller_impl.cc',
       'browser/profiler_controller_impl.h',
       'browser/profiler_message_filter.cc',
       'browser/profiler_message_filter.h',
       'browser/push_messaging/push_messaging_message_filter.cc',
       'browser/push_messaging/push_messaging_message_filter.h',
       'browser/push_messaging/push_messaging_router.cc',
       'browser/push_messaging/push_messaging_router.h',
@@ -1405,16 +1406,18 @@
       '<(SHARED_INTERMEDIATE_DIR)/content/browser/tracing/grit/tracing_resources.h',
       '<(SHARED_INTERMEDIATE_DIR)/ui/resources/grit/webui_resources_map.cc',
       # These files are generated by devtools_protocol_constants_generator.py.
       '<(SHARED_INTERMEDIATE_DIR)/content/browser/devtools/devtools_protocol_constants.cc',
       '<(SHARED_INTERMEDIATE_DIR)/content/browser/devtools/devtools_protocol_constants.h',
       # These files are generated by devtools_protocol_handler_generator.py.
       '<(SHARED_INTERMEDIATE_DIR)/content/browser/devtools/protocol/devtools_protocol_handler_impl.cc',
       '<(SHARED_INTERMEDIATE_DIR)/content/browser/devtools/protocol/devtools_protocol_handler_impl.h',
+      '<(DEPTH)/../../../shared/port/content/browser/power_save_blocker_oxide.cc',
+      '<(DEPTH)/../../../shared/port/content/browser/power_save_blocker_oxide.h',
     ],
     'android_browser_sources': [
       'browser/android/java/gin_java_bound_object.cc',
       'browser/android/java/gin_java_bound_object.h',
       'browser/android/java/gin_java_bound_object_delegate.cc',
       'browser/android/java/gin_java_bound_object_delegate.h',
       'browser/android/java/gin_java_bridge_dispatcher_host.cc',
       'browser/android/java/gin_java_bridge_dispatcher_host.h',
